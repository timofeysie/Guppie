<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: directives/dateValidate.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: directives/dateValidate.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';
/**
 * @fileOverview Date validation for forms.
 * Directive to parse the date to override the custom date validation which
 * could be set to a specific locale.  In Chrome the date chooser forces the
 * date into a yyyy/mm/dd format.  So we create a date based on the value
 * passed in and if it is not rejected as invalide, then our validation will pass.
 * Also, we reuqire that there should be three values, ie: day, month, and year.
 * @memberOf gulpAngular.directives
 * @class dateValidate
 * @ngdoc directive
 * @name dateValidate
  * @preturns {Object} link function
  * @param {Object} scope
  * @param {Element} elm, attrs, ctrl)
  * @param {Array} attrs
  * @param {Function} controller
  * @example Usage:
&lt;input 	id="birthday_id"
	type="date" 
	name="birthday"
	ng-model="user.birthday"
	ng-change="fm.calculateAge()"
	date-validate/>
 */
angular.module('gulpAngular.directives')
.directive('dateValidate', function () {
	return {
		require: 'ngModel',
		restrict: 'A',
		/**
		* @attr {Object} scope is scope
		* @attr {Object} elem is element
		* @attr {Object} attrs are attributes
		* @attr {Object} ctrl is controller
		*/
		link: function (scope, elm, attrs, ctrl) {
			var validator = function (value) {
				var date = new Date(value);
				var day = date.getDate();
				var month = date.getMonth()+1;
				var year = date.getFullYear();
				function parseFormat(value) {
					var part0OK = false;
					var part1OK = false;
					var sep = '/';
					if (value.indexOf('/') ===  -1) {
						sep = '-';
					}
					var parts = value.split(sep);
					//console.log('parts 0 '+parts[0]+' 1 '+parts[1]+' 2 '+parts[2]); 
					var part0 = parseInt(parts[0]);
					var part1 = parseInt(parts[1]);
					if ((part0 > 0) &amp;&amp; (part0 &lt; 31)) {
						part0OK = true;
					}
					if ((part1 > 0) &amp;&amp; (part1 &lt;13)) {
						part1OK = true;
					}
					return (part0OK &amp;&amp; part1OK);
				}
				if (date.toString() === 'Invalid Date') {
					ctrl.$setValidity('validDate', false);
					if ((value === '') || (typeof value === 'undefined')) {
						console.log('date is \'\' or undefined');
						ctrl.$setValidity('validDate', false);  // no date or undefined
					} else if (day === 0 || month === 0 || year === 0)
					{
						console.log('missing something: day '+day+' month '+month+' year '+year);
						ctrl.$setValidity('validDate', false); // not a complete date
					} else if (day === isNaN || month === isNaN || year === isNaN)
					{
						console.log('NaN: day '+day+' month '+month+' year '+year);
						ctrl.$setValidity('validDate', false); // something is NaN
					} else if (parseFormat(value)) {
						console.log('Format parse OK');
						ctrl.$setValidity('validDate', true); // Date is able to parse input
					}
				} else
				{
					console.log('OK: day '+day+' month '+month+' year '+year);
					if (year &lt; 1900)
					{
						ctrl.$setValidity('validDate', false);  // sanity check
					} else
					{
						ctrl.$setValidity('validDate', true); // year is OK
					}
				}
				return value;
			};
			ctrl.$parsers = [validator]; // replace all other validators
			ctrl.$formatters = [validator];
		}
	};
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="module-main.html">main</a></li></ul><h3>class</h3><ul><li><a href="dateValidate.html">dateValidate</a></li></ul><h3>Global</h3><ul><li><a href="global.html#link">link</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> 
    using <a href="https://github.com/allenhwkim/angular-jsdoc">Angular-JSDoc template </a> 
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
<script>
  // scroll to the current document navigation
  var href=window.location.href.match(/\/([^\/]+$)/)[1];
  if (currentNav = document.querySelector("nav a[href='"+href+"']"))
    currentNav.scrollIntoView(true);
  // scroll to the top of the document
  if (window.location.hash == "")
    document.querySelector("body").scrollIntoView(true);
  // adjust the width of main section by navigation width
  // var navWidth = document.querySelector('nav').getBoundingClientRect().width;
  // var mainWidth = document.querySelector('#main').getBoundingClientRect().width;
  // document.querySelector('#main').style.width = (mainWidth - navWidth)+'px';
</script>
</body>
</html>
